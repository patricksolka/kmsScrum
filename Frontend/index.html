<script>
    // Function to add a new task
    function newElement() {
        let name = document.getElementById("myInput").value;
        let beschreibung = "Sample description"; // Add a description if needed

        if (name === "") {
            alert("Please enter a task name!");
            return;
        }

        // Send new task to the backend
        fetch('http://localhost:3000/api/aufgabe', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name: name, beschreibung: beschreibung })
        })
            .then(response => response.json())
            .then(task => {
                // Display the task in the list
                addTaskToDOM(task);
                document.getElementById("myInput").value = ""; // Clear input field
            });
    }

    // Function to add tasks to the DOM
    function addTaskToDOM(task) {
        let li = document.createElement("li");
        li.className = "list-group-item";
        li.appendChild(document.createTextNode(task.name + " - " + task.beschreibung));

        // Add delete button to each task
        let span = document.createElement("span");
        span.innerHTML = "&times;";
        span.className = "close btn btn-danger btn-sm float-end";
        span.onclick = function() {
            this.parentElement.remove();
        };
        li.appendChild(span);

        document.getElementById("ToDoListe").appendChild(li);
    }

    // Fetch tasks on page load
    window.onload = function() {
        fetch('http://localhost:3000/api/aufgaben')
            .then(response => response.json())
            .then(tasks => {
                tasks.forEach(addTaskToDOM);
            });
    };
</script>
